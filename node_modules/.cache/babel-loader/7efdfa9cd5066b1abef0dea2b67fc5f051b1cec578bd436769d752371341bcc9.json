{"ast":null,"code":"import { collection, getDocs, getDoc, doc } from 'firebase/firestore';\nimport { auth, db } from './config';\nimport { signOut } from \"firebase/auth\"; // Import the signOut function from \"firebase/auth\"\n\nexport async function load(sessionId) {\n  try {\n    const querySnapshot = await getDocs(collection(db, 'session'));\n    return processQuerySnapshot(querySnapshot, sessionId);\n  } catch (error) {\n    console.error('Failed to load user sessions:', error);\n    throw new Error('Failed to load user sessions');\n  }\n}\nasync function processQuerySnapshot(querySnapshot, sessionId) {\n  const data = [];\n\n  // Iterate over each session document\n  for (const doc of querySnapshot.docs) {\n    // Extract session data\n    const sessionData = {\n      id: doc.id,\n      ...doc.data()\n    };\n\n    // If the session ID matches the requested session ID, return the session data\n    if (sessionData.id === sessionId) {\n      return [sessionData];\n    }\n  }\n\n  // If no session with the requested session ID was found, return an empty array\n  return [];\n}\nasync function fetchPlayerData(playerIds) {\n  const playerData = [];\n\n  // Fetch player documents from the database based on player IDs\n  for (const playerId of playerIds) {\n    const playerDoc = await getDoc(doc(db, 'players', playerId));\n    if (playerDoc.exists()) {\n      playerData.push(playerDoc.data());\n    }\n  }\n  return playerData;\n}\nexport async function logout() {\n  try {\n    await signOut(auth);\n    return true;\n  } catch (error) {\n    console.error(error);\n    throw new Error(`Failed: ${error.message}`);\n  }\n}\n\n// Function to load session data including players for a given session ID\nexport async function load2(sessionId) {\n  try {\n    // Fetch the session document based on session ID\n    const sessionDoc = await getDoc(doc(db, 'session', sessionId));\n    if (!sessionDoc.exists()) {\n      // Session document not found, return empty array\n      return [];\n    }\n\n    // Extract session data\n    const sessionData = {\n      id: sessionDoc.id,\n      ...sessionDoc.data()\n    };\n\n    // Include player data if available\n    if (sessionData.players) {\n      // Fetch player data from the database based on player IDs\n      const playerData = await fetchPlayerData(sessionData.players);\n      // Add player data to the session object\n      sessionData.players = playerData;\n    }\n    return [sessionData]; // Return session data in an array\n  } catch (error) {\n    console.error('Failed to load session data:', error);\n    throw new Error('Failed to load session data');\n  }\n}","map":{"version":3,"names":["collection","getDocs","getDoc","doc","auth","db","signOut","load","sessionId","querySnapshot","processQuerySnapshot","error","console","Error","data","docs","sessionData","id","fetchPlayerData","playerIds","playerData","playerId","playerDoc","exists","push","logout","message","load2","sessionDoc","players"],"sources":["C:/Users/vsvil/OneDrive/FANSHAWE FILES/Winter 2024/FullStack/VivaArroyo-LocalRepo1/pickleplayApp/src/database/read.js"],"sourcesContent":["import { collection, getDocs, getDoc, doc } from 'firebase/firestore';\r\nimport { auth, db } from './config';\r\nimport { signOut } from \"firebase/auth\"; // Import the signOut function from \"firebase/auth\"\r\n\r\nexport async function load(sessionId) {\r\n  try {\r\n    const querySnapshot = await getDocs(collection(db, 'session'));\r\n    return processQuerySnapshot(querySnapshot, sessionId);\r\n  } catch (error) {\r\n    console.error('Failed to load user sessions:', error);\r\n    throw new Error('Failed to load user sessions');\r\n  }\r\n}\r\n\r\nasync function processQuerySnapshot(querySnapshot, sessionId) {\r\n  const data = [];\r\n\r\n  // Iterate over each session document\r\n  for (const doc of querySnapshot.docs) {\r\n    // Extract session data\r\n    const sessionData = {\r\n      id: doc.id,\r\n      ...doc.data(),\r\n    };\r\n\r\n    // If the session ID matches the requested session ID, return the session data\r\n    if (sessionData.id === sessionId) {\r\n      return [sessionData];\r\n    }\r\n  }\r\n\r\n  // If no session with the requested session ID was found, return an empty array\r\n  return [];\r\n}\r\n\r\nasync function fetchPlayerData(playerIds) {\r\n  const playerData = [];\r\n\r\n  // Fetch player documents from the database based on player IDs\r\n  for (const playerId of playerIds) {\r\n    const playerDoc = await getDoc(doc(db, 'players', playerId));\r\n    if (playerDoc.exists()) {\r\n      playerData.push(playerDoc.data());\r\n    }\r\n  }\r\n\r\n  return playerData;\r\n}\r\n\r\nexport async function logout() { \r\n  try {\r\n      await signOut(auth); \r\n      return true;\r\n  }\r\n  catch (error) {\r\n      console.error(error);\r\n      throw new Error(`Failed: ${error.message}`); \r\n    \r\n  }\r\n}\r\n\r\n\r\n// Function to load session data including players for a given session ID\r\nexport async function load2(sessionId) {\r\n  try {\r\n    // Fetch the session document based on session ID\r\n    const sessionDoc = await getDoc(doc(db, 'session', sessionId));\r\n    \r\n    if (!sessionDoc.exists()) {\r\n      // Session document not found, return empty array\r\n      return [];\r\n    }\r\n\r\n    // Extract session data\r\n    const sessionData = {\r\n      id: sessionDoc.id,\r\n      ...sessionDoc.data(),\r\n    };\r\n\r\n    // Include player data if available\r\n    if (sessionData.players) {\r\n      // Fetch player data from the database based on player IDs\r\n      const playerData = await fetchPlayerData(sessionData.players);\r\n      // Add player data to the session object\r\n      sessionData.players = playerData;\r\n    }\r\n\r\n    return [sessionData]; // Return session data in an array\r\n  } catch (error) {\r\n    console.error('Failed to load session data:', error);\r\n    throw new Error('Failed to load session data');\r\n  }\r\n}"],"mappings":"AAAA,SAASA,UAAU,EAAEC,OAAO,EAAEC,MAAM,EAAEC,GAAG,QAAQ,oBAAoB;AACrE,SAASC,IAAI,EAAEC,EAAE,QAAQ,UAAU;AACnC,SAASC,OAAO,QAAQ,eAAe,CAAC,CAAC;;AAEzC,OAAO,eAAeC,IAAIA,CAACC,SAAS,EAAE;EACpC,IAAI;IACF,MAAMC,aAAa,GAAG,MAAMR,OAAO,CAACD,UAAU,CAACK,EAAE,EAAE,SAAS,CAAC,CAAC;IAC9D,OAAOK,oBAAoB,CAACD,aAAa,EAAED,SAAS,CAAC;EACvD,CAAC,CAAC,OAAOG,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,+BAA+B,EAAEA,KAAK,CAAC;IACrD,MAAM,IAAIE,KAAK,CAAC,8BAA8B,CAAC;EACjD;AACF;AAEA,eAAeH,oBAAoBA,CAACD,aAAa,EAAED,SAAS,EAAE;EAC5D,MAAMM,IAAI,GAAG,EAAE;;EAEf;EACA,KAAK,MAAMX,GAAG,IAAIM,aAAa,CAACM,IAAI,EAAE;IACpC;IACA,MAAMC,WAAW,GAAG;MAClBC,EAAE,EAAEd,GAAG,CAACc,EAAE;MACV,GAAGd,GAAG,CAACW,IAAI,CAAC;IACd,CAAC;;IAED;IACA,IAAIE,WAAW,CAACC,EAAE,KAAKT,SAAS,EAAE;MAChC,OAAO,CAACQ,WAAW,CAAC;IACtB;EACF;;EAEA;EACA,OAAO,EAAE;AACX;AAEA,eAAeE,eAAeA,CAACC,SAAS,EAAE;EACxC,MAAMC,UAAU,GAAG,EAAE;;EAErB;EACA,KAAK,MAAMC,QAAQ,IAAIF,SAAS,EAAE;IAChC,MAAMG,SAAS,GAAG,MAAMpB,MAAM,CAACC,GAAG,CAACE,EAAE,EAAE,SAAS,EAAEgB,QAAQ,CAAC,CAAC;IAC5D,IAAIC,SAAS,CAACC,MAAM,CAAC,CAAC,EAAE;MACtBH,UAAU,CAACI,IAAI,CAACF,SAAS,CAACR,IAAI,CAAC,CAAC,CAAC;IACnC;EACF;EAEA,OAAOM,UAAU;AACnB;AAEA,OAAO,eAAeK,MAAMA,CAAA,EAAG;EAC7B,IAAI;IACA,MAAMnB,OAAO,CAACF,IAAI,CAAC;IACnB,OAAO,IAAI;EACf,CAAC,CACD,OAAOO,KAAK,EAAE;IACVC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;IACpB,MAAM,IAAIE,KAAK,CAAE,WAAUF,KAAK,CAACe,OAAQ,EAAC,CAAC;EAE/C;AACF;;AAGA;AACA,OAAO,eAAeC,KAAKA,CAACnB,SAAS,EAAE;EACrC,IAAI;IACF;IACA,MAAMoB,UAAU,GAAG,MAAM1B,MAAM,CAACC,GAAG,CAACE,EAAE,EAAE,SAAS,EAAEG,SAAS,CAAC,CAAC;IAE9D,IAAI,CAACoB,UAAU,CAACL,MAAM,CAAC,CAAC,EAAE;MACxB;MACA,OAAO,EAAE;IACX;;IAEA;IACA,MAAMP,WAAW,GAAG;MAClBC,EAAE,EAAEW,UAAU,CAACX,EAAE;MACjB,GAAGW,UAAU,CAACd,IAAI,CAAC;IACrB,CAAC;;IAED;IACA,IAAIE,WAAW,CAACa,OAAO,EAAE;MACvB;MACA,MAAMT,UAAU,GAAG,MAAMF,eAAe,CAACF,WAAW,CAACa,OAAO,CAAC;MAC7D;MACAb,WAAW,CAACa,OAAO,GAAGT,UAAU;IAClC;IAEA,OAAO,CAACJ,WAAW,CAAC,CAAC,CAAC;EACxB,CAAC,CAAC,OAAOL,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;IACpD,MAAM,IAAIE,KAAK,CAAC,6BAA6B,CAAC;EAChD;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}